

import java.sql.Connection;
import java.sql.Statement;
import java.sql.DriverManager;
import java.sql.ResultSet;

public class ConnectDB {

	public static void main(String[] args) {
		try {
		
		String url="jdbc:postgresql://localhost:5432/postgres";
		String user="postgres";
		String password="#Mastani14";
		
		Class.forName("org.postgresql.Driver");
		
		Connection c=DriverManager.getConnection(url,user,password);
		
		Statement s=c.createStatement();
		
		String s1="select * from reshu_emp";
		String s2="insert into reshu_emp(empid,ename,dept_no) values(20,'hell',52)";
		String s3="delete from reshu_emp where ename='hell'";
		
		int r=s.executeUpdate(s3);
		
		System.out.println("no of lines get effected....."+r);
		
		ResultSet rst=s.executeQuery(s1);
		
		while(rst.next()) {
			String empn=rst.getString("ename");
			int eid=rst.getInt("empid");
			int dept=rst.getInt("dept_no");
		
		System.out.println("empno...."+ empn +"   employeee id......"+ eid +"  department number....."+dept);
		}
		s.close();
		c.close();
		rst.close();
		}
		catch(Exception e) {
			e.printStackTrace();
		}
		
	}

}


/**************************************************/
import java.sql.Connection;
import java.sql.Statement;
import java.sql.DriverManager;
import java.sql.ResultSet;

public class ConnectDB {

	public static void main(String[] args) {
		try {
		
		String url="jdbc:postgresql://localhost:5432/postgres";
		String user="postgres";
		String password="#Mastani14";
		
		Class.forName("org.postgresql.Driver");
		
		Connection c=DriverManager.getConnection(url,user,password);
		
		Statement s=c.createStatement();
		
		String c1="create table example(std_id int,std_name varchar(10),section int)";
		String c3="insert into example(std_id,std_name,section) values(52,'masti',01)";
		String c2="select * from example";
		
		int r=s.executeUpdate(c3);
		
		System.out.println("no of lines get effected....."+r);
		
		ResultSet rst=s.executeQuery(c2);
		
		while(rst.next()) {
			String stdname=rst.getString("std_name");
			int stdid=rst.getInt("std_id");
			int section=rst.getInt("section");
		
		System.out.println("student name...."+ stdname +"   student id......"+ stdid +"  section name....."+section);
		}
		s.close();
		c.close();
		rst.close();
		}
		catch(Exception e) {
			e.printStackTrace();
		}
		
	}

}

/******************************************************************************************/
import java.sql.Connection;
import java.sql.Statement;
import java.sql.DriverManager;
import java.sql.ResultSet;

public class ConnectDB {

	public static void main(String[] args) {
		try {
		
		String url="jdbc:postgresql://localhost:5432/postgres";
		String user="postgres";
		String password="#Mastani14";
		
		Class.forName("org.postgresql.Driver");
		
		Connection c=DriverManager.getConnection(url,user,password);
		
		Statement s=c.createStatement(ResultSet.TYPE_SCROLL_SENSITIVE,ResultSet.CONCUR_UPDATABLE);
		
		//String c1="create table example(std_id int,std_name varchar(10),section int)";
		//String c3="insert into example(std_id,std_name,section) values(52,'masti',01)";
		String c2="select * from example";
		
		//int r=s.executeUpdate(c3);
		
		//System.out.println("no of lines get effected....."+r);
		
		ResultSet rst=s.executeQuery(c2);
		
		while(rst.next()) {
			String stdname=rst.getString("std_name");
			int stdid=rst.getInt("std_id");
			int section=rst.getInt("section");
		
		System.out.println("student name...."+ stdname +"   student id......"+ stdid +"  section name....."+section);
		
		
            // Modify the salary of the employee with id=1 (hypothetical change)
            if (stdid == 52) {
                rst.updateInt("section", 2);
                rst.updateRow(); // Commit the update to the database
                System.out.println("Updated id of student");
            }
        }
		rst.beforeFirst();
		while(rst.next()) {
			String stdname=rst.getString("std_name");
			int stdid=rst.getInt("std_id");
			int section=rst.getInt("section");
		
		System.out.println("student name...."+ stdname +"   student id......"+ stdid +"  section name....."+section);
		}
		s.close();
		c.close();
		rst.close();
		}
		catch(Exception e) {
			e.printStackTrace();
		}
		
	}

}
/*** prepared Statement using select query*******/
import java.sql.Connection;
import java.sql.Statement;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

public class ConnectDB {

	public static void main(String[] args) {
		try {
		
		String url="jdbc:postgresql://localhost:5432/postgres";
		String user="postgres";
		String password="#Mastani14";
		
		Class.forName("org.postgresql.Driver");
		
		Connection c=DriverManager.getConnection(url,user,password);
		
		//Statement s=c.createStatement();
		
		
		String c2="select * from example where std_id=?";
		PreparedStatement p=c.prepareStatement(c2);
		p.setInt(1, 52);
		
		//int r=s.executeUpdate(c3);
		
		//System.out.println("no of lines get effected....."+r);
		
		ResultSet rst=p.executeQuery();
		
            
		while(rst.next()) {
			String stdname=rst.getString("std_name");
			int stdid=rst.getInt("std_id");
			int section=rst.getInt("section");
		
		System.out.println("student name...."+ stdname +"   student id......"+ stdid +"  section name....."+section);
		}
		p.close();
		c.close();
		rst.close();
		}
		catch(Exception e) {
			e.printStackTrace();
		}
		
	}

}
